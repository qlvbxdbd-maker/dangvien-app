<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Danh sách Đảng viên</title>

  <!-- Fonts & base -->
  <style>
    body{font-family:"Times New Roman",serif; line-height:1.5}
    .toolbar{display:flex; gap:10px; align-items:center; margin:10px 0}
    .btn{padding:8px 14px; border:1px solid #ccc; background:#f7f7f7; cursor:pointer}
    .btn-primary{background:#1677ff; color:#fff; border-color:#1677ff}
    .btn-success{background:#16a34a; color:#fff; border-color:#16a34a}
    .btn-outline{background:#fff}

    table{width:100%; border-collapse:collapse}
    th,td{border:1px solid #e5e7eb; padding:8px}
    th{background:#1d4ed8; color:#fff}
    .text-center{text-align:center}

    /* Ẩn toolbar khi in */
    @media print{
      .toolbar,.pagination,#filters,#pageSizeWrapper,
      #btnRefresh,#btnExportExcel,#btnPrintList{display:none!important}
      body{font-family:"Times New Roman",serif}
    }
  </style>

  <!-- (Giữ nguyên/đã có) các thư viện bạn đang dùng: XLSX, dayjs... -->

  <!-- Thêm 2 CDN để xuất DOCX cho MODAL chi tiết -->
  <script src="https://unpkg.com/docx@8.0.1/build/index.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
</head>
<body>

  <h1 class="text-center">Danh sách Đảng viên</h1>

  <!-- toolbar bộ lọc/nút – KHÔNG có nút Xuất DOCX ở đây -->
  <div id="filters" class="toolbar">
    <input id="txtSearch" placeholder="không phân biệt hoa thường, có thể bỏ dấu…" style="flex:1; padding:8px" />
    <input id="fromDate" type="text" placeholder="dd/mm/yyyy" style="width:140px; padding:8px">
    <input id="toDate"   type="text" placeholder="dd/mm/yyyy" style="width:140px; padding:8px">
    <select id="statusFilter" style="padding:8px">
      <option value="all">Tất cả trạng thái</option>
      <option value="active">Đang sinh hoạt</option>
      <option value="pause">Nghỉ sinh hoạt</option>
      <option value="transfer">Chuyển đảng</option>
    </select>
    <select id="pageSize" style="padding:8px">
      <option value="10">10 dòng/trang</option>
      <option value="20">20</option>
      <option value="50">50</option>
      <option value="100">100</option>
      <option value="all">Tất cả</option>
    </select>

    <button id="btnRefresh" class="btn btn-primary">Làm mới</button>
    <button id="btnExportExcel" class="btn btn-success">Xuất Excel (.xlsx)</button>
    <button id="btnPrintList" class="btn btn-outline">In</button>
    <!-- ĐÃ BỎ nút Xuất DOCX ở danh sách -->
  </div>

  <table id="tblMembers">
    <thead>
      <tr>
        <th style="width:60px">STT</th>
        <th>Họ và tên</th>
        <th style="width:90px">Giới tính</th>
        <th>Đơn vị/Bộ phận</th>
        <th style="width:120px">Chi bộ</th>
        <th style="width:140px">Số thẻ Đảng viên</th>
        <th style="width:120px">Ngày vào Đảng</th>
        <th style="width:90px">Tuổi Đảng</th>
        <th style="width:220px">E-mail</th>
        <th style="width:140px">Trạng thái</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="toolbar pagination" style="justify-content:flex-end">
    <button id="btnPrev" class="btn">Trước đó</button>
    <span id="pageInfo"></span>
    <button id="btnNext" class="btn">Kế tiếp</button>
  </div>

  <!-- Modal chi tiết – chỉ nêu khung, bạn đang có modal sẵn thì GIỮ; chỉ cần chắc có 2 nút id dưới -->
  <div id="memberModal" style="display:none"></div>
  <!-- trong modal của bạn nhớ có 2 nút: -->
  <!-- <button id="btnPrintMember">In</button> -->
  <!-- <button id="btnExportMemberDocx">Xuất DOCX</button> -->

  <script src="./app.js"></script>
</body>
</html>
