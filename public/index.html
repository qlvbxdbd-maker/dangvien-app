<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <title>Danh sách Đảng viên</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Times New Roman toàn site -->
  <style>
    :root{
      --primary:#2563eb;
      --row:#0ea5e9;
      --border:#e5e7eb;
      --text:#111827;
      --muted:#6b7280;
      --bg:#f8fafc;
    }
    html,body{
      font-family: "Times New Roman", Times, serif;
      color:var(--text);
      background:var(--bg);
      margin:0;
      padding:0;
    }
    .container{max-width:1240px; margin:28px auto; padding:0 16px;}
    h1{margin:0 0 18px; font-size:28px; font-weight:700;}

    .toolbar{
      display:flex; flex-wrap:wrap; gap:10px; align-items:center; margin:8px 0 14px;
    }
    .toolbar input[type="text"], .toolbar input[type="date"], .toolbar select{
      height:40px; padding:0 12px; border:1px solid var(--border); border-radius:8px; background:#fff;
    }
    .toolbar .grow{ flex:1 1 350px; min-width:280px; }
    .btn{
      height:40px; border-radius:8px; border:1px solid var(--primary);
      background:var(--primary); color:#fff; padding:0 14px; cursor:pointer; font-weight:600;
    }
    .btn-outline{ background:#fff; color:var(--primary); }
    .btn:disabled{ opacity:.6; cursor:not-allowed; }

    .table{
      width:100%; border-collapse:collapse; background:#fff; border:1px solid var(--border);
      border-radius:10px; overflow:hidden;
    }
    .table thead th{
      background:var(--primary); color:#fff; text-align:left; padding:12px 14px; font-size:15px;
    }
    .table tbody td{
      border-top:1px solid var(--border); padding:12px 14px; vertical-align:top;
    }
    .table tbody tr:nth-child(odd){ background:#f9fbff; }
    .table tbody tr:hover{ background:#eef5ff; }

    .footer{
      display:flex; align-items:center; justify-content:space-between; gap:16px; margin-top:12px; color:var(--muted);
      flex-wrap:wrap;
    }
    .pager{display:flex; gap:8px;}
    .pager .btn{height:36px; padding:0 12px;}
    .count{font-size:14px;}
    .sep{color:#cbd5e1}
    small{color:var(--muted);}

    @media (max-width: 640px){
      .hide-sm{ display:none; }
    }
  </style>

  <!-- SheetJS – xuất XLSX -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.19.3/dist/xlsx.full.min.js"></script>
</head>
<body>
  <div class="container">
    <h1>Danh sách Đảng viên</h1>

    <div class="toolbar">
      <input id="q" class="grow" type="text"
             placeholder="Tìm theo tên, email (không phân biệt hoa thường)..." />

      <label class="hide-sm"><small>Từ ngày:</small><br/>
        <input id="from" type="date">
      </label>

      <label class="hide-sm"><small>Đến ngày:</small><br/>
        <input id="to" type="date">
      </label>

      <select id="pageSize" title="Số dòng/trang">
        <option value="10">10 dòng/trang</option>
        <option value="20">20 dòng/trang</option>
        <option value="50">50 dòng/trang</option>
        <option value="100">100 dòng/trang</option>
      </select>

      <button id="btnRefresh" class="btn">Làm mới</button>

      <label style="display:flex; align-items:center; gap:6px; margin-left:auto">
        <input id="chkAll" type="checkbox"> <small>Xuất <b>tất cả</b> (bỏ qua phân trang)</small>
      </label>
      <button id="btnExport" class="btn btn-outline">Xuất Excel (.xlsx)</button>
    </div>

    <table class="table">
      <thead>
      <tr>
        <th style="width:70px">STT</th>
        <th>Họ và tên</th>
        <th class="hide-sm">Giới tính</th>
        <th class="hide-sm">Đơn vị/Bộ phận</th>
        <th class="hide-sm">Chi bộ</th>
        <th class="hide-sm">Số thẻ Đảng viên</th>
        <th>Ngày vào Đảng</th>
        <th>Tuổi Đảng</th>
        <th>E‑mail</th>
      </tr>
      </thead>
      <tbody id="tbody">
      <tr><td colspan="9">Đang tải dữ liệu…</td></tr>
      </tbody>
    </table>

    <div class="footer">
      <div class="count">
        <span id="showing">Hiển thị —</span>
        <span class="sep">•</span>
        <span id="updated">Cập nhật: —</span>
      </div>
      <div class="pager">
        <button id="prev" class="btn btn-outline">Trước đó</button>
        <span id="pageInfo" style="align-self:center"></span>
        <button id="next" class="btn btn-outline">Kế tiếp</button>
      </div>
    </div>
  </div>

  <script src="./app.js"></script>
</body>
</html>
